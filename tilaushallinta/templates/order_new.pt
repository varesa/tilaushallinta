<!--!
# This source code is licensed under the terms of the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.
# To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/4.0/.
# Copyright Esa Varemo 2014
-->

<metal:main metal:use-macro="load: master.pt">
    <metal:main metal:fill-slot="title">Tee tilaus</metal:main>

    <metal:main metal:fill-slot="head_custom">
        <link rel="stylesheet" href="/static/lomake.css"/>
        <script type="text/javascript">
            $(document).ready(function() {
                var pattern =  /([^<]*)(.*)/;
                var lines = $(".required");
                lines.each(function(index, element) {
                    if($(element).children("label").length) {
                        $(element).children("label").append('<span class="asterisk">*</span>');
                    } else {
                        var matches = pattern.exec($(element).html());
                        var label = matches[1];
                        var rest = matches[2];
                        $(element).html(label + '<span class="asterisk">*</span>' + rest);
                    }
                });
            });

            function check_input() {
                var invalid = false;
                $(".required input, .required textarea").each(function(index, element) {
                    if($(element).prop("type") == 'checkbox') {
                        console.log("checkbox found")
                        if(!$(element).prop("checked")) {
                            invalid = true;
                            console.log("Checkbox empty");
                        }
                    } else if($(element).prop("type") == 'textarea') {
                        console.log("textarea found");
                        if($(element).val().length == 0) {
                            invalid = true;
                            console.log("Textarea empty");
                        }
                    } else if($(element).prop("type") == 'text') {
                        console.log("textfield found");
                        if($(element).val().length == 0) {
                            invalid = true;
                            console.log("Text field empty");
                        }
                    }
                });
                return !invalid;
            }
        </script>
    </metal:main>

    <div metal:fill-slot="content">
        <form id="lomake" method="POST" action="/tilaukset/submit" onsubmit="return check_input()">
            <table class="table_lomake">
                <tr>
                    <td><h2>Uusi tilaus</h2></td>
                </tr>
                <tr>
                    <td><h3>Laskutustiedot / Tilaaja</h3></td> <td><h3>Työn kohteen tiedot</h3></td>
                </tr>
                <tr>
                    <td class="required">Nimi:<br><input name="tilaaja_nimi" tabindex="1"></td>
                    <td class="required">Nimi:<br><input name="kohde_nimi"   tabindex="9"></td>
                </tr>
                <tr>
                    <td>Yritys:            <br><input name="tilaaja_yritys" tabindex="2"></td>
                    <td>Yritys (taloyhtiö):<br><input name="kohde_yritys"   tabindex="10"></td>
                </tr>
                <tr>
                    <td>Y-tunnus:<br><input name="tilaaja_ytunnus" tabindex="3"></td>
                    <td>Y-tunnus:<br><input name="kohde_ytunnus"   tabindex="11"></td>
                </tr>
                <tr>
                    <td class="required">Osoite:<br><input name="tilaaja_osoite" tabindex="4"></td>
                    <td class="required">Osoite:<br><input name="kohde_osoite"   tabindex="12"></td>
                </tr>
                <tr>
                    <td class="required">Postinumero:<br><input name="tilaaja_postinumero" tabindex="5"></td>
                    <td class="required">Postinumero:<br><input name="kohde_postinumero"   tabindex="13"></td>
                </tr>
                <tr>
                    <td class="required">Postitoimipaikka:<br><input name="tilaaja_postitoimipaikka" tabindex="6"></td>
                    <td class="required">Postitoimipaikka:<br><input name="kohde_postitoimipaikka"   tabindex="14"></td>
                </tr>
                <tr>
                    <td class="required">Puhelin:<br><input name="tilaaja_puh" tabindex="7"></td>
                    <td>Puhelin:                 <br><input name="kohde_puh"   tabindex="15"></td>
                </tr>
                <tr>
                    <td>Sähköposti:              <br><input name="tilaaja_email" tabindex="8"></td>
                    <td>Sähköposti:              <br><input name="kohde_email"   tabindex="16"></td>
                </tr>
                <tr>
                    <td>Sähköiset laskutustiedot:<br><textarea name="slaskutus" tabindex="9"></textarea></td>
                    <td><input type="checkbox" id="checkbox_tiedot_samat"> <label for="checkbox_tiedot_samat">Samat kuin laskutustiedot</label></td>
                </tr>
                <tr>
                    <td colspan="2">Muut yhteyshenkilöt:<br><textarea name="muut_yhteysh" tabindex="17"></textarea></td>
                </tr>

                <tr>
                    <td class="required" colspan="2">Työn kuvaus:<br><textarea name="tyo" tabindex="18"></textarea></td>
                </tr>
                <tr>
                    <td colspan="2" tabindex="19">Viitenumero:<br><input name="viitenumero"></td>
                </tr>
                <tr>
                    <td class="required"><input type="checkbox" id="checkbox_ehdot" tabindex="20"> <label for="checkbox_ehdot">Olen lukenut ja hyväksyn <a href="/texts/tilausehdot" target="_blank">ehdot</a> sekä voimassa olevan <a>hinnaston</a></label></td>
                    <td><input type="checkbox" id="checkbox_maksu" tabindex="21" name="maksuaika" value="7"> <label for="checkbox_maksu">Nopea maksu (7pv netto)</label></td>
                </tr>

                <tr>
                    <td colspan="2"><input type="submit"  tabindex="22" value="Tee tilaus"></td>
                </tr>
            </table>
        </form>

    </div>
</metal:main>